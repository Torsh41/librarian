API {Безымянный проект} v.0.2.0
===============================

Данный документ содержит документацию для программного 
интерфейса приложения (API), обеспечивающего 
взаимодействие веб-сервера и базы данных.

## TOC

- [Точка входа](#entrypoint)

- [Аутентификация](#auth)

- [Доступные функции](#functions)

    - [Пользователи](#users)
  
    - [Файлы](#files)
  
    - [Посты](#posts)


## Точка входа

Для обращения к API необходимо сформировать GET (либо POST; 
см. [Файлы](#files)) запрос к адресу:

``` 
https://api.{domain}/method/METHOD
```

Где METHOD - название используемого метода.

Пример ответа API:

```json
{
  "response": {
    "id": 11,
    "name": "Василий Пупкин"
  }
}
```

Пример ответа API в случае возникновения ошибки:

```json
{
  "error": {
    "error_code": 102
  }
}
```

## Аутентификация

Для аутентификации пользователя API требуется передавать 
обязательный параметр `key` в каждом запросе, содержащий ключ.
Ключ имеет вид `XXXX-XXXX-XXXX`, где `X` - некоторый 
алфавитно-цифровой символ.

Пример запроса с аутентификацией:

```
https://api.{domain}/method/users/get?key=XXXX-XXXX-XXXX&id=101
```

Код ошибки `011` зарезервирован для случая неудачной 
аутентификации пользователя API. Код ошибки `012` 
свидетельствует о недостаточном уровне допуска используемого 
ключа для выполнения запрошенной функции.

Аутентификация по логину и паролю для получения API-ключа имеет 
следующий вид:

```
/method/auth/auth
```

Возвращает API-ключ в случае успеха.

**Параметры:**

- `userpass64` - совмещённые логин и пароль, кодированные Base64.

**Коды ошибок:**

- `013` - неверный логин или пароль.


## Доступные функции 

API предоставляет функции для чтения и изменения информации о 
[пользователях](#users), [файлах](#files) и [постах](#posts).

### 1. Пользователи

```
/method/users/FUNCTION
```

Предоставляет доступ к информации о пользователях, 
зарегистрированных на сайте, а также позволяет добавлять, 
изменять и удалять учетные записи пользователей.

Доступны следующие функции:

---

1. **get** - возвращает JSON с данными о пользователе с 
заданным ID.

**Параметры:**

- `id` - идентификатор пользователя; положительное число.

**Коды ошибок:**

`111` - пользователя с таким ID не существует

---

2. **add** - добавляет пользователя. В случае успеха 
возвращает `id` созданного пользователя.

**Параметры:**

- `name` - имя пользователя

- `password` - пароль пользователя

**Коды ошибок:**

`121` - пользователь с таким именем уже существует

`122` - некорректный формат одного или более полей (знаки 
препинания в имени, превышение максимальной длины, пустое 
поле, ...)

---

3. **change** - позволяет изменить информацию о пользователе. 
В случае успеха возвращает `id` изменённого пользователя.

**Параметры:**

- `id` - идентификатор пользователя; положительное число.

**Дополнительные параметры:**

Один или более параметр должен быть включен в запрос:

- `name` - новое имя пользователя

- `password` - новый пароль пользователя

**Коды ошибок:**

`111` - пользователя с таким ID не существует

`121` - пользователь с таким именем уже существует

`122` - некорректный формат одного или более полей (знаки 
препинания в имени, превышение максимальной длины, пустое 
поле, ...)

---

4. **remove** - удаляет учётную запись пользователя.

**Параметры:** 

- `id` - идентификатор пользователя; положительное число.

**Коды ошибок:**

`111` - пользователя с таким ID не существует

### 2. Файлы

```
/method/files/FUNCTION
```

Предоставляет интерфейс для работы с файлами: загрузка, 
скачивание и получение данных о хранящихся материалах.

Доступны следующие функции:

---

1. **getmeta** - возвращает информацию о файле с заданным ID.

**Параметры:**

- `id` - идентификатор файла; положительное число.

**Коды ошибок:**

`211` - файла с таким ID не существует

---

2. **add** - *POST-запрос;* добавляет файл на сервер.

**Параметры:**

- `file` - тело файла

**Коды ошибок:**

- [ ] TODO

---

3. **remove** - удалить файл с заданным ID.

**Параметры:**

- `id` - идентификатор файла; положительное число.

**Коды ошибок:**

`211` - файла с таким ID не существует

---

4. **get** - *POST-запрос;* скачать файл с сервера.

**Параметры:**

- `id` - идентификатор файла; положительное число.

**Коды ошибок:**

`211` - файла с таким ID не существует

---

5. **search** - найти файл по метаданным.

**Параметры:**

- [ ] TODO


### 3. Посты

```
/method/posts/FUNCTION
```

Предоставляет доступ к информации о постах, а также позволяет 
создавать, изменять и удалять посты на форуме.

Доступные функции:

---

1. **get** - получить информацию о посте с заданным ID.

**Параметры:**

- `id` - идентификатор поста; положительное число.

**Коды ошибок:**

`311` - поста с таким ID не существует

---

2. **post** - создать новый пост.

**Параметры:**

- `title` - название поста.

- `body` - тело поста.

---

3. **remove** - удалить пост с заданным ID.

**Параметры:**

- `id` - идентификатор поста; положительное число.

**Коды ошибок:**

`311` - поста с таким ID не существует

---

4. **change** - изменить название/содержимое поста с заданным 
ID.

**Параметры:**

- `id` - идентификатор поста; положительное число.

- `title` - новое название поста.

- `body` - новое тело поста.

**Коды ошибок:**

`311` - поста с таким ID не существует

